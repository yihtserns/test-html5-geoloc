<html>
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"></meta>
    <meta content="utf-8" http-equiv="encoding"></meta>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
    <script type="text/javascript">
        function sendLocation() {
          var geolocator = navigator.geolocation;
          if (geolocator) {
            geolocator.getCurrentPosition(function(position) {
              var lat = position.coords.latitude;
              var long = position.coords.longitude;
              var time = Date.now();
              var locationText = "Time: " + time + ", Latitude: " + lat + ", Longitude: " + long;

              var req = $.post('/report', { time: time, lat: lat, long: long }, function() {
                $("#sentLocations").append('<li>' + locationText + '</li>');
              }).fail(function() {
                $("#unsentLocations").append('<li>' + locationText + '</li>');
              });
            });
          } else {
            alert("Cannot access GPS function, is it disabled?");
          }
        }

        function startSendLocation(seconds) {
          window.setInterval(sendLocation, seconds * 1000)
        }
    </script>
  </head>
  <body>
    <input type="button" onclick="startSendLocation(5)" value="Send Location every 5 seconds"/>
    <h3>Sent successfully</h3>
    <ol id="sentLocations">
    </ol>
    <h3>Failed to send</h3>
    <ol id="unsentLocations">
    </ol>
  </body>
</html>
